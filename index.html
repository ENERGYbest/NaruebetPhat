<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ผลงาน | นฤเบศ แพทย์ประสิทธิ์</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    


</head>
<body>
    
    <div class="background-container">
        <div class="aurora-bg">
            <div class="blob one"></div>
            <div class="blob two"></div>
            <div class="blob three"></div>
        </div>
        <div class="stars-bg"></div>
        <div class="stars-bg-2"></div>
    </div>

    <div class="portfolio-container">
        <div class="spotlight-container">
            <div class="spotlight-image-wrapper">
                <img id="spotlight-image" src="" alt="">
            </div>
            <div class="spotlight-info">
                <h2 id="spotlight-title"></h2>
                <a id="spotlight-link" href="#" target="_blank">ดูผลงาน</a>
            </div>
        </div>
        <div class="project-list-container">
            <h3 class="list-header">รายการผลงาน</h3>
            <div id="project-list"></div>
        </div>
    </div>

    <script>
        const projects = [
            { title: "19-5-68 (ออกแบบ Layout หน้าเว็บไซต์)", image: "19-5-68/finish/1layout.png", link: "19-5-68/index.html" },
            { title: "22-5-68 (semantic element)", image: "22-5-68/finish/layout.png", link: "22-5-68/index2.html" },
            { title: "26-5-68 (การสร้างตาราง)", image: "26-5-68/finish/website.png", link: "26-5-68/index2.html" },
            { title: "29-5-68 (การสร้างฟอร์ม Login)", image: "29-5-68/finish/login web.png", link: "29-5-68/login.html" },
            { title: "5-6-68 (responsive layout flex box)", image: "5-6-68/finish/web tatc.png", link: "5-6-68/index2.html" },
            { title: "9-6-68 (การสร้าง Grid Layout)", image: "9-6-68/finish/2web.png", link: "9-6-68/index2.html" },
            { title: "16-6-68 (ออกแบบเว็บด้วย HTML และ CSS)", image: "16-6-68/finish/web.png", link: "16-6-68/index.html" },
            { title: "19-26-6-68 (สร้างวิทยาลัยเคนิคสัตหีบ,Modal)", image: "19-6-68-boostrap/finish/web.png", link: "19-6-68-boostrap/index.html" }
        ];
        
        const portfolioContainer = document.querySelector('.portfolio-container');
        const projectList = document.getElementById('project-list');
        const spotlightImage = document.getElementById('spotlight-image');
        const spotlightTitle = document.getElementById('spotlight-title');
        const spotlightLink = document.getElementById('spotlight-link');
        let isAnimating = false;

        function animateTitle(newText = null) {
            const chars = spotlightTitle.querySelectorAll('.char');
            if (chars.length > 0) {
                chars.forEach((char, i) => {
                    char.style.transitionDelay = `${i * 15}ms`;
                    char.style.transform = 'translateY(110%)';
                });
            }
            if (newText) {
                setTimeout(() => {
                    spotlightTitle.innerHTML = '';
                    newText.split('').forEach(charText => {
                        const charSpan = document.createElement('span');
                        charSpan.className = 'char';
                        charSpan.textContent = charText === ' ' ? '\u00A0' : charText;
                        spotlightTitle.appendChild(charSpan);
                    });
                    setTimeout(() => {
                        const newChars = spotlightTitle.querySelectorAll('.char');
                        newChars.forEach((char, i) => {
                            char.style.transitionDelay = `${i * 25}ms`;
                            char.style.transform = 'translateY(0)';
                        });
                    }, 20);
                }, 300);
            }
        }

        function populateProjectList() {
            projects.forEach((project, index) => {
                const item = document.createElement('div');
                item.className = 'project-list-item';
                item.textContent = project.title;
                item.dataset.index = index;
                item.addEventListener('click', () => {
                    if(!item.classList.contains('active')) updateSpotlight(index)
                });
                projectList.appendChild(item);
            });
        }
        
        // --- (แก้ไข) อัปเดตฟังก์ชัน updateSpotlight ทั้งหมด ---
        function updateSpotlight(index) {
            if (isAnimating) return;
            isAnimating = true;

            const project = projects[index];

            // 1. สั่งให้ Title และรูปภาพปัจจุบันจางหายไป
            animateTitle();
            spotlightImage.style.animationName = 'fade-out';
            spotlightImage.classList.add('fading');

            // 2. ตั้งเวลาเพื่อเปลี่ยนข้อมูลหลังจากอนิเมชั่น fade-out ทำงานเสร็จ
            setTimeout(() => {
                // 2.1 อัปเดต Source ของรูปภาพและ Link
                spotlightImage.src = project.image;
                spotlightLink.href = project.link;

                // 2.2 อัปเดต Title พร้อมอนิเมชั่น
                animateTitle(project.title);

                // 2.3 สั่งให้รูปภาพใหม่ปรากฏขึ้น (Fade in)
                spotlightImage.style.animationName = 'fade-in';

                // อัปเดตคลาส active ในลิสต์รายการ
                document.querySelectorAll('.project-list-item').forEach(item => item.classList.remove('active'));
                document.querySelector(`.project-list-item[data-index='${index}']`).classList.add('active');

            }, 500); // ระยะเวลาต้องเท่ากับ animation-duration ใน CSS

            // 3. เมื่ออนิเมชั่นทั้งหมดเสร็จสิ้น
            setTimeout(() => {
                spotlightImage.classList.remove('fading'); // ลบคลาสเพื่อเตรียมพร้อมสำหรับครั้งถัดไป
                isAnimating = false; // ปลดล็อคการคลิก
            }, 1000); // ระยะเวลารวมของ fade-out (500ms) + fade-in (500ms)
        }

        spotlightLink.addEventListener('click', function(event) {
            event.preventDefault();
            const destinationUrl = this.href;
            portfolioContainer.classList.add('page-exit');
            setTimeout(() => { window.location.href = destinationUrl; }, 500);
        });

        function init() {
            populateProjectList();
            if (projects.length > 0) {
                const firstProject = projects[0];
                spotlightImage.src = firstProject.image;
                spotlightLink.href = firstProject.link;
                animateTitle(firstProject.title);
                document.querySelector(`.project-list-item[data-index='0']`).classList.add('active');
            }
        }
        
        init();
    </script>
</body>
</html>
